# UKG Rest Client

[![CircleCI](https://circleci.com/gh/adityai/ukg_rest_client.svg?style=svg)](https://circleci.com/gh/adityai/ukg_rest_client)

## Developer's disclosure

I need to demonstrate my skills as a software developer with skills for software integration by consuming external web services, specifically the ones hosted by Ultimate Kronos Group (UKG). UKG is a provider of cloud based workforce management software. UKG's developer portal and the web services are accessible only to customers. So, I asked Amazon Q to generate mock web services based on the API specification that is publicly available at https://doc.people-doc.com/client/api/index-v2.html. 

The code at the root of the repository was implemented by me. 

The code in the mock_ukg_rest directory in this repository was generated by Amazon Q. 

The test_ukg_api_client_pytest.py was generated by Amazon Q.

The outout of union_leave_workflow.py was made visually appealing for the demo by Amazon Q.

## Additional list of implemented features
- Unit tests 
- Packaging rest client as a python module
- Circleci build that runs unit tests and packages the rest client as a python module

## Run the mock server

```
cd mock_ukg_rest
pip install -r requirements.txt
python mock_server.py
```

## Run the client

```
cd ..
pip install -r requirements.txt
export UKG_APP_ID="test_app"
export UKG_APP_SECRET="test_secret"
export UKG_CLIENT_ID="test_client"
export UKG_COMPANY_SHORT_NAME="your_company_short_name"
export UKG_BASE_URL="http://localhost:8080"
python ukg_api_client.py
```

## Run the 'union leave workflow':

```
python union_leave_workflow.py
```

### Description: Union leave workflow
This script demonstrates a workflow for processing a union member's time off request. It includes the following steps:
1. **Initialization**: Sets up the UKG API client with mock credentials and base URL
2. **Time Off Request Creation**: Creates a time off request for a specific employee
3. **Union Entitlement Check**: Verifies if the employee is entitled to union leave
4. **Accrual Balance Verification**: Checks if the employee has sufficient PTO accrued
5. **Compliance Evaluation**: Assesses compliance violations and parameters related to the time off request
6. **Approval Process**: Approves the time off request if all checks pass

### Design of the external database
Since UKG does not have a union entitlement and compliance module an external sqlite database is designed to store union entitlement and compliance data. The database includes the following tables:
- `unions`: Stores union information
- `union_members`: Links employees to their respective unions
- `entitlements`: Defines various union leave entitlements
- `member_entitlements`: Associates union members with their specific entitlements

Additionally, a simple web service client 'union_entitlements_service.py' is created to get data from this external database.

## For Production (Real UKG Pro Services)

To connect to actual UKG Pro web services:

### 1. Obtain UKG Pro Credentials

- **UKG Pro Developer Account**: Register at [UKG Developer Portal](https://developer.ukg.com)
- **API Credentials**: Request from your UKG Pro administrator
- **Company Short Name**: Your UKG Pro company identifier

### 2. Environment URLs

| Environment | Base URL | Description |
|-------------|----------|-------------|
| Production US | `https://api.ultipro.com` | Live production environment |
| Sandbox US | `https://sandbox-api.ultipro.com` | Testing environment |
| Production Canada | `https://ca-api.ultipro.com` | Canadian production |
| Production UK | `https://uk-api.ultipro.com` | UK production |

### 3. Authentication Requirements

- **Application ID**: Unique identifier for your application
- **Application Secret**: Secret key for OAuth authentication  
- **Client ID**: Client identifier for token scope
- **Company Short Name**: Your UKG Pro company identifier
- **Scope**: Format: `https://api.ultipro.com/{company_short_name}`

### 4. Environment Variables Setup

```bash
UKG_APP_ID=your_actual_application_id
UKG_APP_SECRET=your_actual_application_secret
UKG_CLIENT_ID=your_actual_client_id
UKG_COMPANY_SHORT_NAME=your_company_short_name
UKG_BASE_URL=https://api.ultipro.com
```

## Additional data

UKG Pro does not host all the data required by an employer that deals with unions. Additional sample data has been created in a standalone sqlite database for hosting union entitlement data.

The sqlite database file is named `union_entitlements.db` and is located in the external_data subdirectory.

The database has the following tables:
- unions
- union_members
- entitlements
- member_entitlements


